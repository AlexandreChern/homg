<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>HoMG by hsundar</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <script src="javascripts/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1 class="header">HoMG</h1>
        <p class="header">High-order Geometric Multigrid using Hexahedral Finite Elements</p>

        <ul>
          <li class="download"><a class="buttons" href="https://github.com/hsundar/homg/zipball/master">Download ZIP</a></li>
          <li class="download"><a class="buttons" href="https://github.com/hsundar/homg/tarball/master">Download TAR</a></li>
          <li><a class="buttons github" href="https://github.com/hsundar/homg">View On GitHub</a></li>
        </ul>

        <p class="header">This project is maintained by <a class="header name" href="https://github.com/hsundar">hsundar</a></p>


      </header>
      <section>
        <h1>
<a name="homg-high-order-multi-grid" class="anchor" href="#homg-high-order-multi-grid"><span class="octicon octicon-link"></span></a>HoMG (High-Order Multi Grid)</h1>

<p><img src="https://raw.github.com/hsundar/homg/gh-pages/images/mgrids.png" alt="mesh"></p>

<p>High-order finite-element package using hexahedral elements. The code is a
testbed for geometric multigrid approaches for high order discretizations. The
current implementation supports setting up a combination of $h$ and $p$
heirarchy. The following smoothers are supported,</p>

<ul>
<li>Jacobi</li>
<li>Chebyshev-accelerated Jacobi</li>
<li>block Jacobi</li>
<li>Symmetric SOR </li>
</ul><h3>
<a name="basic-usage" class="anchor" href="#basic-usage"><span class="octicon octicon-link"></span></a>Basic Usage</h3>

<p>A simple example in 2D</p>

<div class="highlight highlight-matlab"><pre>
<span class="c">% specify the coefficients</span>
<span class="n">mu</span> <span class="p">=</span> <span class="p">@(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)(</span><span class="mi">1</span> <span class="o">+</span> <span class="mf">1e6</span><span class="o">*</span><span class="p">(</span> <span class="nb">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="nb">pi</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>^<span class="mi">2</span> <span class="o">+</span> <span class="nb">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="nb">pi</span><span class="o">*</span><span class="n">y</span><span class="p">)</span>^<span class="mi">2</span> <span class="p">)</span> <span class="p">);</span>

<span class="c">% create the mesh heirarchy, for a warped mesh</span>
<span class="c">% in this case we create a h+p heirarchy</span>
<span class="c">%     grid 4 --&gt; 32x32, p=4  (finest)</span>
<span class="c">%     grid 3 --&gt; 32x32, p=2      </span>
<span class="c">%     grid 2 --&gt; 32x32, p=1</span>
<span class="c">%     grid 1 --&gt; 16x16, p=1</span>
<span class="c">%     grid 0 --&gt;  8x8,  p=1  (coarsest)</span>

<span class="n">g</span> <span class="p">=</span> <span class="n">create_hexmesh_grids</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="p">@</span><span class="n">homg</span><span class="p">.</span><span class="n">xform</span><span class="p">.</span><span class="n">shell</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">8</span> <span class="mi">16</span> <span class="mi">32</span><span class="p">]);</span>

<span class="c">% now solve using multigrid as the solver and the choice of smoother</span>
<span class="n">g</span><span class="p">.</span><span class="n">solve</span> <span class="p">(</span><span class="mi">150</span><span class="p">,</span> <span class="s">'jacobi'</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="n">g</span><span class="p">.</span><span class="n">L</span><span class="p">,</span> <span class="n">g</span><span class="p">.</span><span class="n">get_u0</span><span class="p">);</span>
<span class="n">g</span><span class="p">.</span><span class="n">solve</span> <span class="p">(</span><span class="mi">150</span><span class="p">,</span> <span class="s">'chebyshev'</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="n">g</span><span class="p">.</span><span class="n">L</span><span class="p">,</span> <span class="n">g</span><span class="p">.</span><span class="n">get_u0</span><span class="p">);</span>
<span class="n">g</span><span class="p">.</span><span class="n">solve</span> <span class="p">(</span><span class="mi">150</span><span class="p">,</span> <span class="s">'ssor'</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">g</span><span class="p">.</span><span class="n">L</span><span class="p">,</span> <span class="n">g</span><span class="p">.</span><span class="n">get_u0</span><span class="p">);</span>

<span class="c">% or solve using CG preconditioned using multigrid</span>
<span class="n">g</span><span class="p">.</span><span class="n">solve_pcg</span><span class="p">(</span><span class="mi">150</span><span class="p">,</span> <span class="s">'jacobi'</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="n">g</span><span class="p">.</span><span class="n">L</span><span class="p">,</span> <span class="n">g</span><span class="p">.</span><span class="n">get_u0</span><span class="p">);</span>
<span class="n">g</span><span class="p">.</span><span class="n">solve_pcg</span><span class="p">(</span><span class="mi">150</span><span class="p">,</span> <span class="s">'chebyshev'</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="n">g</span><span class="p">.</span><span class="n">L</span><span class="p">,</span> <span class="n">g</span><span class="p">.</span><span class="n">get_u0</span><span class="p">);</span>
<span class="n">g</span><span class="p">.</span><span class="n">solve_pcg</span><span class="p">(</span><span class="mi">150</span><span class="p">,</span> <span class="s">'ssor'</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">g</span><span class="p">.</span><span class="n">L</span><span class="p">,</span> <span class="n">g</span><span class="p">.</span><span class="n">get_u0</span><span class="p">);</span>

</pre></div>

<p>The 3D example is similar with a few changes in the grid setup.</p>

<div class="highlight highlight-matlab"><pre>
<span class="c">% specify the coefficients</span>
<span class="n">mu</span> <span class="p">=</span> <span class="p">@(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">10</span>^<span class="mi">6</span><span class="o">*</span><span class="p">(</span> <span class="nb">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="nb">pi</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>^<span class="mi">2</span> <span class="o">+</span> <span class="nb">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="nb">pi</span><span class="o">*</span><span class="n">y</span><span class="p">)</span>^<span class="mi">2</span> <span class="o">+</span> <span class="nb">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="nb">pi</span><span class="o">*</span><span class="n">z</span><span class="p">)</span>^<span class="mi">2</span><span class="p">)</span> <span class="p">);</span>

<span class="c">% create the mesh heirarchy, for a warped mesh</span>
<span class="c">% in this case we create a h+p heirarchy</span>
<span class="c">%     grid 4 --&gt; 8x8x8, p=4  (finest)</span>
<span class="c">%     grid 3 --&gt; 8x8x8, p=2      </span>
<span class="c">%     grid 2 --&gt; 8x8x8, p=1</span>
<span class="c">%     grid 1 --&gt; 4x4x4, p=1</span>
<span class="c">%     grid 0 --&gt; 2x2x2, p=1  (coarsest)</span>

<span class="n">g</span> <span class="p">=</span> <span class="n">create_hexmesh_grids</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="p">@</span><span class="n">homg</span><span class="p">.</span><span class="n">xform</span><span class="p">.</span><span class="n">shell</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span> <span class="mi">4</span> <span class="mi">8</span><span class="p">]);</span>

<span class="c">% now solve using multigrid as the solver and the choice of smoother</span>
<span class="n">g</span><span class="p">.</span><span class="n">solve</span> <span class="p">(</span><span class="mi">150</span><span class="p">,</span> <span class="s">'jacobi'</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="n">g</span><span class="p">.</span><span class="n">L</span><span class="p">,</span> <span class="n">g</span><span class="p">.</span><span class="n">get_u0</span><span class="p">);</span>
<span class="n">g</span><span class="p">.</span><span class="n">solve</span> <span class="p">(</span><span class="mi">150</span><span class="p">,</span> <span class="s">'chebyshev'</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="n">g</span><span class="p">.</span><span class="n">L</span><span class="p">,</span> <span class="n">g</span><span class="p">.</span><span class="n">get_u0</span><span class="p">);</span>
<span class="n">g</span><span class="p">.</span><span class="n">solve</span> <span class="p">(</span><span class="mi">150</span><span class="p">,</span> <span class="s">'ssor'</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">g</span><span class="p">.</span><span class="n">L</span><span class="p">,</span> <span class="n">g</span><span class="p">.</span><span class="n">get_u0</span><span class="p">);</span>

<span class="c">% or solve using CG preconditioned using multigrid</span>
<span class="n">g</span><span class="p">.</span><span class="n">solve_pcg</span><span class="p">(</span><span class="mi">150</span><span class="p">,</span> <span class="s">'jacobi'</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="n">g</span><span class="p">.</span><span class="n">L</span><span class="p">,</span> <span class="n">g</span><span class="p">.</span><span class="n">get_u0</span><span class="p">);</span>
<span class="n">g</span><span class="p">.</span><span class="n">solve_pcg</span><span class="p">(</span><span class="mi">150</span><span class="p">,</span> <span class="s">'chebyshev'</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="n">g</span><span class="p">.</span><span class="n">L</span><span class="p">,</span> <span class="n">g</span><span class="p">.</span><span class="n">get_u0</span><span class="p">);</span>
<span class="n">g</span><span class="p">.</span><span class="n">solve_pcg</span><span class="p">(</span><span class="mi">150</span><span class="p">,</span> <span class="s">'ssor'</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">g</span><span class="p">.</span><span class="n">L</span><span class="p">,</span> <span class="n">g</span><span class="p">.</span><span class="n">get_u0</span><span class="p">);</span>

</pre></div>

<h3>
<a name="authors-and-contributors" class="anchor" href="#authors-and-contributors"><span class="octicon octicon-link"></span></a>Authors and Contributors</h3>

<p>Hari Sundar(<a href="https://github.com/hsundar" class="user-mention">@hsundar</a>) and Georg Stadler(<a href="https://github.com/georgst" class="user-mention">@georgst</a>).</p>

<h3>
<a name="support-or-contact" class="anchor" href="#support-or-contact"><span class="octicon octicon-link"></span></a>Support or Contact</h3>

<p>Email questions or suggestions to <a href="mailto:hari@ices.utexas.edu">hari@ices.utexas.edu</a> </p>
      </section>
      <footer>
        <p><small>Hosted on <a href="http://pages.github.com">GitHub Pages</a> using the Dinky theme</small></p>
      </footer>
    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
		
  </body>
</html>
